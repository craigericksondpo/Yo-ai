# 5.3 Remedial workflow generator contract
# This is the “learning” part: turning the incident into a future guardrail or compensating workflow.
# agents/remedial-workflow.generator.contract.yaml
agent_id: remedial-workflow.generator
description: >
  Generate draft remedial workflows based on incident context and risk level.

inputs:
  - incident_id: string
  - context: object
  - risk_level: string
  - source_event_type: string

outputs:
  - remedial_workflow_draft:
      type: object
      description: >
        A workflow definition draft with:
        - detection logic (precondition guard, validation, retries)
        - compensating action steps
        - monitoring hooks
Example output structure it might generate:
# Example draft (output from generator)
workflow_id: remediation.workflow.guard_and_retry.auth-service.timeout.v1
name: "Guard + Retry for Auth Service Timeouts"
labels:
  - "remediation"
  - "auto-generated"
triggers:
  - event_type: "auth.request"
    when: 'service == "auth"'

steps:
  - id: call-auth
    type: task
    agent: auth.client
    retry:
      max_attempts: 3
      backoff: exponential
      on_failure: goto compensating-flow

  - id: compensating-flow
    type: task
    agent: notification.sender
    inputs:
      channel: "ops"
      message: "Auth service unstable. Incident {{ incident_id }}."