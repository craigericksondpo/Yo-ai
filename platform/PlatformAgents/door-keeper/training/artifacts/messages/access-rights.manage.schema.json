# Canonical Schema Template: manage-AccessRights
{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://yoai.dev/schemas/manage-access-rights-messageType.json",
  "name": "manage-AccessRights",
  "version": "2026-01-15",
  "artifactType": "messageType",
  "description": "Manage access rights for RegisteredAgents and RegisteredSubscribers.",
  "tags": ["RegisteredAgent", "RegisteredSubscriber", "Visitor"],
  "type": "object",
  "properties": {
    "request": {
      "type": "object",
      "description": "Request to evaluate access rights based on registration and log references.",
      "properties": {
        "registration_identifier_ref": {
          "type": "string",
          "description": "Opaque reference to the registration record."
        },
        "log_refs": {
          "type": "array",
          "items": { "type": "string" },
          "description": "List of log references relevant to the access decision."
        }
      },
      "required": ["registration_identifier_ref", "log_refs"]
    },
    "response": {
      "type": "object",
      "description": "Outcome of the access rights evaluation.",
      "properties": {
        "registration_identifier_ref": {
          "type": "string",
          "description": "Echo of the registration reference for traceability."
        },
        "finding": {
          "type": "string",
          "description": "Access decision or rationale (e.g., 'granted', 'denied', 'escalated')."
        },
        "log_refs": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Subset of logs used in the decision or flagged for review."
        }
      },
      "required": ["registration_identifier_ref", "finding", "log_refs"]
    }
  },
  "required": ["request", "response"]
}